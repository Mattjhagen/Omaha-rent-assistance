<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Omaha Affordable Housing | All-In for Our Neighbors</title>
  <meta name="description" content="Join a heart-led movement to end housing instability in Omaha. Your gift moves a family from the edge to home." />
  <link rel="stylesheet" href="/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://js.stripe.com/v3/"></script>
  <link rel="preload" as="image" href="/images/20220507_004203.jpg">
  <link rel="preload" as="image" href="/images/20220507_004602.jpg">
  <link rel="preload" as="image" href="/images/20220507_005932.jpg">
  <link rel="preload" as="image" href="/images/2023-06-14.jpg">
  <link rel="preload" as="image" href="/images/IMG_1242.JPG">
  <style>
    :root{
      --ink:#0f172a;--muted:#475569;--brand:#0ea5e9;--brand-2:#2563eb;--good:#16a34a;--bg:#f8fafc;--card:#ffffff;--ring:rgba(37,99,235,.2);
    }
    *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.65}
    a{color:var(--brand-2);text-decoration:none}

    /* Header */
    header.hero{position:relative;min-height:92vh;display:grid;place-items:center;overflow:hidden;color:#fff}
    .hero-background{position:absolute;inset:0;background-position:center;background-size:cover;background-repeat:no-repeat;background-color:#333;min-height:100vh;border:2px solid red}
    .hero-fade{position:absolute;bottom:0;left:0;right:0;height:200px;background:linear-gradient(to top, var(--bg) 0%, transparent 100%);z-index:1}
    .hero-content{position:relative;z-index:2;max-width:1100px;padding:24px;text-align:center;margin-top:auto;padding-bottom:60px}

    .cta-row{display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap;margin-top:1.25rem}
    .btn{appearance:none;border:0;border-radius:12px;padding:14px 22px;font-weight:800;cursor:pointer}
    .btn-primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;box-shadow:0 12px 24px rgba(37,99,235,.25)}
    .btn-primary:focus,.btn-primary:hover{outline:0;box-shadow:0 0 0 6px var(--ring),0 12px 24px rgba(2,6,23,.35)}
    .btn-ghost{background:rgba(255,255,255,.14);color:#fff;border:1px solid rgba(255,255,255,.22)}

    /* Progress Card */
    .container{max-width:1200px;margin:0 auto;padding:32px 20px}
    .card{background:var(--card);border:1px solid #e2e8f0;border-radius:20px;box-shadow:0 8px 24px rgba(2,6,23,.06);padding:28px}
    .progress-wrap{display:grid;gap:20px}
    .progress{height:20px;background:#e2e8f0;border-radius:999px;overflow:hidden;position:relative;box-shadow:inset 0 2px 4px rgba(0,0,0,.1)}
    .bar{height:100%;width:0;background:linear-gradient(90deg,var(--brand),var(--brand-2),var(--good));transition:width 1200ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;overflow:hidden}
    .bar::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:shimmer 2s infinite}
    @keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
    @keyframes slideIn{0%{transform:translateX(100%);opacity:0}100%{transform:translateX(0);opacity:1}}
    .progress-label{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .progress-percentage{font-weight:800;color:var(--brand-2);font-size:1.1rem}
    .stats{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px}
    .stat{padding:20px;border:1px solid #e2e8f0;border-radius:16px;text-align:center;background:linear-gradient(135deg,#fff,#f8fafc);transition:transform 200ms ease,box-shadow 200ms ease}
    .stat:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(2,6,23,.1)}
    .kpi{font-size:1.75rem;font-weight:800;color:var(--brand-2);margin-bottom:4px} 
    .label{color:var(--muted);font-weight:600;font-size:0.9rem}

    /* Sections */
    section{margin:42px 0}
    h2{font-size:clamp(1.4rem,3.5vw,2.25rem);margin:.25rem 0 10px;font-weight:800}
    p.lead{font-size:1.125rem;color:#0b1324}
    .grid{display:grid;gap:18px}
    .goals{grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}
    .goal{padding:18px 16px;border:1px dashed #dbe3ef;border-radius:14px;background:#fff}
    .goal strong{color:var(--brand-2)}

    /* Donation box */
    aside.donate{position:sticky;top:18px}
    .amounts{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin:16px 0}
    .chip{padding:12px 8px;border-radius:12px;border:1px solid #e2e8f0;background:#fff;font-weight:700;cursor:pointer;text-align:center;transition:all 200ms ease;font-size:0.9rem}
    .chip:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(37,99,235,.15)}
    .chip.active{border-color:var(--brand-2);color:var(--brand-2);box-shadow:0 0 0 4px var(--ring);background:linear-gradient(135deg,#f0f9ff,#e0f2fe)}
    .field{display:flex;gap:8px;margin-top:16px}
    .field input{flex:1;padding:12px 14px;border-radius:12px;border:1px solid #dfe3ea;font-weight:700;font-size:1rem}
    .field input:focus{outline:none;border-color:var(--brand-2);box-shadow:0 0 0 4px var(--ring)}

    /* Footer */
    footer{background:#0b1324;color:#e6edf7;padding:36px 20px;margin-top:56px}
    .foot{max-width:1200px;margin:0 auto;display:grid;gap:8px}
    small.cites{opacity:.8}

    @media (max-width: 900px){
      .stats{grid-template-columns:1fr}
      .amounts{grid-template-columns:repeat(2,1fr)}
    }
  </style>
</head>
<body>
  <header class="hero" aria-label="Inspirational header with call to action">
    <img src="/images/verse.JPG" alt="Inspirational verse" class="hero-background" style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:0;">
    <div class="hero-fade"></div>

    <div class="hero-content">
      <div class="cta-row">
        <button id="donateNow" class="btn btn-primary">Donate Now</button>
        <a href="#how" class="btn btn-ghost">See how your gift helps</a>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="card" aria-live="polite">
      <div class="progress-wrap">
        <div style="display:flex;gap:12px;align-items:end;flex-wrap:wrap;margin-bottom:16px">
          <div>
            <div style="font-weight:800;font-size:2.25rem;color:var(--brand-2)" id="raised">$0</div>
            <div class="label">raised of $1,000,000 goal</div>
          </div>
          <div style="margin-left:auto;font-weight:700;color:var(--muted);text-align:right">
            <div style="font-size:1.1rem">Campaign Day <span id="day">1</span></div>
            <div style="font-size:0.9rem;opacity:0.8">$1M for Omaha Housing</div>
          </div>
        </div>
        <div class="progress-label">
          <span class="label">Progress to $1 Million Goal</span>
          <span class="progress-percentage" id="percentage">0%</span>
        </div>
        <div class="progress" aria-label="Fundraising progress">
          <div id="bar" class="bar"></div>
        </div>
        <div class="stats">
          <div class="stat">
            <div class="kpi" id="donors">0</div>
            <div class="label">Generous Donors</div>
          </div>
          <div class="stat">
            <div class="kpi" id="families">0</div>
            <div class="label">Families on the path to home</div>
          </div>
          <div class="stat">
            <div class="kpi" id="daysLeft">365</div>
            <div class="label">Days remaining</div>
          </div>
        </div>
      </div>
    </div>

    <section id="how" class="grid" style="grid-template-columns:2fr 1fr;gap:22px">
      <article class="card">
        <h2>Why we act now</h2>
        <p class="lead">Housing costs keep rising while paychecks don't. Some respond by pushing people out of sight. We respond by pulling people into community — with dignity, housing, and care.</p>
        <div class="grid goals">
          <div class="goal"><strong>$400,000</strong><br/>Emergency Housing Fund – keep families housed and safe tonight.</div>
          <div class="goal"><strong>$300,000</strong><br/>First Keys – down-payment help and coaching for first‑time buyers.</div>
          <div class="goal"><strong>$200,000</strong><br/>Innovation Lab – tiny homes, ADUs, motel conversions.</div>
          <div class="goal"><strong>$100,000</strong><br/>Operations & Impact – transparent delivery of every dollar.</div>
        </div>
      </article>

      <aside class="card donate">
        <h2 style="margin-bottom:12px">Make a gift</h2>
        <p style="font-size:0.9rem;color:var(--muted);margin-bottom:16px">Every dollar brings us closer to our $1M goal</p>
        <div class="amounts" id="amounts">
          <button class="chip" data-amt="25">$25</button>
          <button class="chip" data-amt="50">$50</button>
          <button class="chip" data-amt="100">$100</button>
          <button class="chip" data-amt="250">$250</button>
          <button class="chip" data-amt="500">$500</button>
          <button class="chip" data-amt="1000">$1,000</button>
          <button class="chip" data-amt="2500">$2,500</button>
          <button class="chip" data-amt="5000">$5,000</button>
          <button class="chip" data-amt="10000">$10,000</button>
        </div>
        <div class="field">
          <input id="custom" type="number" min="1" step="1" placeholder="Other amount (USD)" aria-label="Custom amount"/>
          <button id="give" class="btn btn-primary" style="white-space:nowrap">Donate Now</button>
        </div>
        <div style="margin-top:12px;padding:12px;background:#f8fafc;border-radius:8px;border-left:4px solid var(--brand)">
          <div style="font-size:0.85rem;color:var(--muted)">
            <strong>Secure & Tax-Deductible</strong><br/>
            Payments processed by Stripe • 501(c)(3) eligible
          </div>
        </div>
      </aside>
    </section>

    <section class="card">
      <h2>What your gift makes possible</h2>
      <p class="lead">From the first hot shower to a signed lease, your generosity fuels each step. When we invest in people, we don't just reduce homelessness — we grow a stronger Omaha.</p>
      <div class="grid goals">
        <div class="goal"><strong>Street‑to‑Home</strong><br/>Rapid placements from encampments and cars into safe rooms and supportive housing.</div>
        <div class="goal"><strong>Care, not cuffs</strong><br/>On‑site case managers connect neighbors to mental health and recovery care alongside housing.</div>
        <div class="goal"><strong>Lasting stability</strong><br/>Financial coaching, job support, and tenant protections that keep families housed.</div>
      </div>
    </section>
  </div>

  <footer>
    <div class="foot">
      <strong>Omaha Affordable Housing Campaign</strong>
      <small>PacMac Mobile LLC • housing@P3Lending.space • 402‑915‑1434 • 1402 Jones St, Omaha, NE 68901</small>
    </div>
  </footer>

  <script>
    let stripe; // set after page loads
    let selected = 50; // default for quick donate

    function setActive(btn){
      document.querySelectorAll('.chip').forEach(b=>b.classList.remove('active'));
      if(btn){btn.classList.add('active');}
    }

    async function updateStats(){
      try{
        const res = await fetch('/api/campaign-stats');
        const data = await res.json();
        const pct = Math.min(100, (data.currentAmount / data.goal) * 100);
        
        // Update main display
        document.getElementById('raised').textContent = `$${Number(data.currentAmount).toLocaleString()}`;
        document.getElementById('percentage').textContent = `${pct.toFixed(1)}%`;
        document.getElementById('donors').textContent = Number(data.donorCount).toLocaleString();
        document.getElementById('families').textContent = Number(data.familiesHelped).toLocaleString();
        
        // Animate progress bar
        setTimeout(() => {
          document.getElementById('bar').style.width = pct + '%';
        }, 100);

        // Calculate campaign timeline
        const start = new Date('2025-01-01');
        const end = new Date('2026-12-31');
        const today = new Date();
        const day = Math.max(1, Math.ceil((today - start)/(1000*60*60*24)));
        const daysLeft = Math.max(0, Math.ceil((end - today)/(1000*60*60*24)));
        document.getElementById('day').textContent = day;
        document.getElementById('daysLeft').textContent = daysLeft;
        
        // Add celebration effect if we hit milestones
        if (pct >= 10 && pct < 10.1) {
          showMilestone('10%', 'Amazing progress!');
        } else if (pct >= 25 && pct < 25.1) {
          showMilestone('25%', 'Quarter of the way there!');
        } else if (pct >= 50 && pct < 50.1) {
          showMilestone('50%', 'Halfway to our goal!');
        } else if (pct >= 75 && pct < 75.1) {
          showMilestone('75%', 'Almost there!');
        } else if (pct >= 100) {
          showMilestone('100%', 'Goal achieved!');
        }
      }catch(e){console.warn('Stats unavailable', e)}
    }

    function showMilestone(percentage, message) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed; top: 20px; right: 20px; z-index: 1000;
        background: linear-gradient(135deg, var(--good), #22c55e);
        color: white; padding: 16px 20px; border-radius: 12px;
        box-shadow: 0 8px 24px rgba(34, 197, 94, 0.3);
        font-weight: 700; animation: slideIn 0.5s ease;
      `;
      notification.innerHTML = `<div style="font-size: 1.1rem">🎉 ${percentage}</div><div style="font-size: 0.9rem; opacity: 0.9">${message}</div>`;
      document.body.appendChild(notification);
      setTimeout(() => notification.remove(), 4000);
    }

    async function createCheckout(amount){
      const res = await fetch('/api/create-checkout-session',{
        method:'POST',headers:{'Content-Type':'application/json'},
        body:JSON.stringify({amount:amount})
      });
      if(!res.ok){throw new Error('Checkout session failed')}
      const {url} = await res.json();
      window.location.href = url;
    }

    function wireDonations(){
      document.getElementById('donateNow').addEventListener('click',()=>createCheckout(selected));
      document.getElementById('give').addEventListener('click',()=>{
        const val = parseInt(document.getElementById('custom').value,10);
        const amount = Number.isFinite(val) && val>0 ? val : selected;
        createCheckout(amount).catch(()=>alert('Could not start checkout. Please try again.'));
      });
      document.querySelectorAll('.chip').forEach(btn=>{
        btn.addEventListener('click',()=>{
          selected = parseInt(btn.dataset.amt,10);
          document.getElementById('custom').value = '';
          setActive(btn);
        });
      });
      // default select $50
      const def = document.querySelector('.chip[data-amt="50"]');
      if(def){setActive(def)}
    }

    document.addEventListener('DOMContentLoaded', async ()=>{
      try{ stripe = Stripe('{{STRIPE_PUBLISHABLE_KEY}}'); }catch(e){ console.warn('Stripe key missing'); }
      await updateStats();
      wireDonations();
    });
  </script>
</body>
</html>
